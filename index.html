<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
      .target {
        position: absolute;
        border-radius: 50%;
      }
      #one {
        top: 0;
        left: 0;
      }
      #two {
        top: 78px;
        left: 78px;
      }
      #three {
        top: 157px;
        left: 157px;
      }
      #four {
        top: 236px;
        left: 236Px;
      }
      #five {
        top: 314px;
        left: 314px;
      }
      #target {
        position: absolute;
        top: 314px;
        left: 314px;
      }
      .currentPlayer {
        background-color: #ff7575
      }
      body {
        background-color: black;
      }
    </style>
  </head>
  <body>
    <!-- Setup Game Modal -->
    <div class="modal fade" id="setupGame" tabindex="-1" aria-labelledby="setupGameLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Setup</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="row">
                <div class="col-lg-4">
                  <label for="numRounds" class="form-label">Number of rounds</label>
                  <div class="input-group">
                    <span class="input-group-btn">
                      <button type="button" class="btn btn-danger btn-number" data-type="minus" data-field="" id="decreaseRounds">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-lg" viewBox="0 0 16 16">
                          <path d="M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z"/>
                        </svg>
                      </button>
                    </span>
                    <input type="text" id="numRounds" name="numRounds" class="form-control input-number" value="10" min="1" max="100">
                    <span class="input-group-btn">
                      <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="" id="increaseRounds">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                          <path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"/>
                        </svg>
                      </button>
                    </span>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-12">
                  <label for="playerInput" class="form-label">Players</label>
                  <div class="input-group">
                    <input type="text" id="playerInput" name="playerInput" class="form-control">
                    <span class="input-group-btn">
                      <button type="button" class="btn btn-outline-dark" id="addPlayer">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                          <path d="M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z"/>
                        </svg>
                      </button>
                    </span>
                    <div class="input-group mb-1" id="playerList"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="saveGameSettings">Save changes</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Reset game modal -->
    <div class="modal" tabindex="-1" id="confirmResetGame">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Reset Game</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Are you sure?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-danger" id="resetGame">RESET</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="container">
      <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="modal" data-bs-target="#setupGame">Setup</button>
      <button type="button" class="btn btn-lg btn-danger" data-bs-toggle="modal" data-bs-target="#confirmResetGame">Reset</button>
      <button type="button" class="btn btn-lg btn-warning" onclick="hit(0)">Zero</button>
      <table class="table table-dark">
        <thead id="score_h"><tr><th scope="col">Player</th><th scope="col">1</th><th scope="col">2</th><th scope="col">3</th><th scope="col">4</th><th scope="col">5</th><th scope="col">Total</th></tr></thead>
        <tbody id="score_b"></tbody>
      </table>
      <div id="target">
        <img class=target id="one" src="assets/one-ring.png" onclick="hit(1)" onmouseover="highlight('one', true)" onmouseout="highlight('one', false)">
        <img class=target id="two" src="assets/two-ring.png" onclick="hit(2)" onmouseover="highlight('two', true)" onmouseout="highlight('two', false)">
        <img class=target id="three" src="assets/three-ring.png" onclick="hit(3)" onmouseover="highlight('three', true)" onmouseout="highlight('three', false)">
        <img class=target id="four" src="assets/four-ring.png" onclick="hit(4)" onmouseover="highlight('four', true)" onmouseout="highlight('four', false)">
        <img class=target id="five" src="assets/five-ring.png" onclick="hit(5)" onmouseover="highlight('five', true)" onmouseout="highlight('five', false)">
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
      var players = [];
      var rounds = 5;
      var currentPlayer = 0;
        
      $('#setupGame').on('show.bs.modal', function (event) {
        $("#numRounds").val(rounds);
      });
      
      $("#decreaseRounds").click(function(){
        rounds --;
        $("#numRounds").val(rounds);
      });
      
      $("#increaseRounds").click(function(){
        rounds ++;
        $("#numRounds").val(rounds);
      });
      
      $("#saveGameSettings").click(function(){
        rounds = $("#numRounds").val();
        console.log("Rounds: "+rounds);
        console.log("Players: "+players.length);
        $("#setupGame").modal('hide');
        generateScoreBoard();
      });
      
      $("#addPlayer").click(function(){
        var playerName = $("#playerInput").val().trim();
        if(playerName){
          players.push({ name: playerName, rounds: [] });
        }
        var playerHTML = '';
        for(var p=0; p<players.length; p++){
          var player = players[p];
          playerHTML += '<span class="input-group-text">'+player.name+'</span><button type="button" class="btn btn-danger" onclick="deletePlayer('+p+')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"><path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/></svg></button><br>';
        }
        $("#playerList").html(playerHTML);
      });
      
      $("#resetGame").click(function(){
        for(var p=0; p<players.length; p++){
          players[p].rounds = [];
        }
        var currentPlayer = 0;
        generateScoreBoard();
        $("#confirmResetGame").modal('hide');
      });
      
      function generateScoreBoard(){
        $("#setupGame").modal('hide');
        var scoreBoardHeadHTML = '<tr><th scope="col">Player</th>';
        for(var r=0; r<rounds; r++){
          scoreBoardHeadHTML += '<th scope="col">'+(r+1)+'</th>';
        }
        scoreBoardHeadHTML += '<th scope="col">Total</th></tr>';
        $("#score_h").html(scoreBoardHeadHTML);
        var scoreBoardBodyHTML = '';
        for(var p=0; p<players.length; p++){
          var player = players[p];
          if(currentPlayer == p){
            scoreBoardBodyHTML += '<tr class="currentPlayer"><td>'+player.name;
          }
          else{
            scoreBoardBodyHTML += '<tr><td>'+player.name;
          }
          var total = 0;
          for(var r=0; r<rounds; r++){
            if(player.rounds[r] || player.rounds[r] == 0){
              scoreBoardBodyHTML += '<td>'+player.rounds[r]+'</td>';
              total += player.rounds[r];
            }
            else{
              scoreBoardBodyHTML += '<td></td>';
            }
          }
          scoreBoardBodyHTML += '<td>'+total+'</td></tr>';
        }
        //if(scoreBoardBodyHTML){
          
          $("#score_b").html(scoreBoardBodyHTML);
        //}
      }
      
      function deletePlayer(playerIndex){
        players.splice(playerIndex, 1);
        var playerHTML = '';
        for(var p=0; p<players.length; p++){
          var player = players[p];
          playerHTML += '<span class="input-group-text">'+player.name+'</span><button type="button" class="btn btn-danger" onclick="deletePlayer('+p+')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"><path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/></svg></button>';
        }
        $("#playerList").html(playerHTML);
      }
      
      function highlight(ring, highlight){
        if(highlight){
          document.getElementById(ring).src="assets/"+ring+"-ring-red.png";
        }
        else{
          document.getElementById(ring).src="assets/"+ring+"-ring.png";
        }
      }
      
      function hit(ring){
        players[currentPlayer].rounds.push(ring);
        if(currentPlayer < (players.length-1)){
          currentPlayer ++;
        }
        else{
          currentPlayer = 0;
        }
        generateScoreBoard();
      }
    </script>
  </body>
</html>